# 更新日志

## v3.1.1 (2026-02-10)

### 记忆注入模板重构（重大更新）
- **完整对齐官方模板**：完全重构记忆注入提示词，与 MemOS 官方模板结构保持一致
- **新增 Skill 支持**：增加 `Skill Data` 章节和 `Critical Protocol: Skill Execution` 技能执行协议
- **技能注入开关**：新增 `enable_skill_injection` 配置项（默认关闭），控制是否启用技能注入功能
- **执行协议增强**：
  - 保留 `Memory Safety` 四步判决协议
  - 新增 `Skill Execution` 四步执行规则（适用性优先/工作流组合/个性化/冲突解决）
- **Instructions 扩展**：从 3 步扩展到 5 步（Filter/Match/Synthesize/Style/Output）
- **格式规范化**：
  - 代码块改为 ` ```xml ` 格式
  - 列表符号统一为 `-`
  - 中文 Query 标记改为 `user原始查询：`
- **新增工具方法**：
  - `format_skill_content()`：格式化技能内容
  - `build_injection_prompt()`：一键构建完整提示词，支持技能开关

---

## 未来规划

### 重构计划
待 MemOS API 提供 `name` 字段支持后（预计2026年3月底），将进行以下重大重构：

#### 多视角记忆上传
- **支持多视角记忆**：利用 MemOS 新增的 `name` 字段，实现多视角记忆上传功能
- **群聊上传机制优化**：修正当前群聊上传机制，支持为不同用户视角分别上传记忆
- **记忆关联增强**：通过多视角标记，更准确地关联和检索记忆

#### 新功能规划
- **跨会话记忆**：实现跨会话记忆共享和检索，打破会话隔离限制
- **记忆维度扩展**：基于多视角支持，构建更丰富的记忆维度体系
- **智能记忆聚合**：优化记忆聚合算法，提供更精准的记忆检索体验

#### 架构优化
- **插件架构重构**：大幅重构插件架构，适配 MemOS 新特性
- **数据模型升级**：升级数据模型以支持多视角和跨会话场景
- **性能优化**：优化记忆上传和检索性能

---

## v3.0.1 (2025-02-10)

### 问题修复
- **修复上传失败问题**：修复配置上传轮数为1（无缓存直接上传）时上传失败的问题

---

## v3.0.0 (2025-02-01)

### 重大更新

#### 全新WebUI控制面板
- **MemOS密钥管理**：新增独立的密钥管理页面，支持添加、编辑、删除多个MemOS API密钥
  - 支持为不同Bot和会话配置不同的API密钥
  - 密钥值使用AES加密存储和传输，确保安全
  - 默认密钥保护机制，防止误删

#### 增强的配置管理
- **API密钥选择**：Bot和会话级别均可独立选择使用的MemOS API密钥
  - 支持一键将API密钥配置应用到所有会话
  - 配置优先级：会话配置 > Bot配置 > 默认配置
- **自定义user_id**：支持为不同Bot和会话配置独立的MemOS user_id

#### 用户画像功能
- **WebUI查看用户画像**：在Web管理界面中直接查看用户画像报告
  - 展示用户的事实记忆（用户画像报告）
  - 展示系统推断的偏好洞察区
  - 支持复制用户画像内容
  - 美观的卡片式布局展示记忆详情

#### 界面优化
- 支持亮色/暗色主题切换
- 响应式布局优化，支持PC和移动端
- 会话列表支持展开/折叠
- Bot列表支持搜索和折叠

### 技术改进
- 使用AES加密保护API密钥传输安全
- 优化配置管理的数据模型
- 新增批量应用配置到所有会话的API端点

---

## v1.7.0

### 新增功能
- **加反馈指令**：新增 `/加反馈 <反馈内容>` 命令，支持给指定消息添加反馈

---

## v1.6.0 (历史版本)

### 核心功能
- 自动记忆管理：对话保存和智能检索
- 记忆注入：在LLM请求前注入相关记忆
- 用户指令：支持`/查记忆`、`/用户画像`
- 多语言支持：中文和英文记忆注入
- 安全协议：四步判决确保记忆使用安全